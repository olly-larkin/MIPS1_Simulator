#!/bin/bash

SIM=$1
OUTFILE="test/output/out.csv"
echo "" > $OUTFILE

RUN_TEST() {
    TEST_ID=$1
    INSTRUCTION=$2
    AUTHOR=$3
    EXPECTED_OUTCOME=$5
    if [ $# -ge 6 ]
    then
        echo $6 | $SIM tbench_src/test_bins/$TEST_ID.bin
    else
        $SIM tbench_src/test_bins/$TEST_ID.bin
    fi
    EC=$?
    if [ $EC -eq $EXPECTED_OUTCOME ]
    then
        STATUS="Pass"
    else
        STATUS="Fail"
    fi
    MESSAGE=$4" - exited with code "$EC
    echo $TEST_ID", "$INSTRUCTION", "$STATUS", "$AUTHOR", "$MESSAGE >> $OUTFILE
}

